fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogPtMem <- calculate_cvalue(EcogPtMem)
long_dat$EcogPtMem_cut <- ifelse(long_dat$EcogPtMem > cvalue$EcogPtMem, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogPtMem_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogPtMem <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogPtMem_cut) ~ thirtile, data = .)
logrank_test$EcogPtMem
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogPtMem_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogPtMem_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogPtOrgan <- calculate_cvalue(EcogPtOrgan)
long_dat$EcogPtOrgan_cut <- ifelse(long_dat$EcogPtOrgan > cvalue$EcogPtOrgan, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogPtOrgan_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogPtOrgan <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogPtOrgan_cut) ~ thirtile, data = .)
logrank_test$EcogPtOrgan
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogPtOrgan_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogPtOrgan_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogPtPlan <- calculate_cvalue(EcogPtPlan)
long_dat$EcogPtPlan_cut <- ifelse(long_dat$EcogPtPlan > cvalue$EcogPtPlan, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogPtPlan_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogPtPlan <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogPtPlan_cut) ~ thirtile, data = .)
logrank_test$EcogPtPlan
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogPtPlan_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogPtPlan_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogPtVisspat <- calculate_cvalue(EcogPtVisspat)
long_dat$EcogPtVisspat_cut <- ifelse(long_dat$EcogPtVisspat > cvalue$EcogPtVisspat, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogPtVisspat_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogPtVisspat <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogPtVisspat_cut) ~ thirtile, data = .)
logrank_test$EcogPtVisspat
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogPtVisspat_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogPtVisspat_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogPtTotal <- calculate_cvalue(EcogPtTotal)
long_dat$EcogPtTotal_cut <- ifelse(long_dat$EcogPtTotal > cvalue$EcogPtTotal, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogPtTotal_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogPtTotal <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogPtTotal_cut) ~ thirtile, data = .)
logrank_test$EcogPtTotal
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogPtTotal_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogPtTotal_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogSPDivatt <- calculate_cvalue(EcogSPDivatt)
long_dat$EcogSPDivatt_cut <- ifelse(long_dat$EcogSPDivatt > cvalue$EcogSPDivatt, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogSPDivatt_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogSPDivatt <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogSPDivatt_cut) ~ thirtile, data = .)
logrank_test$EcogSPDivatt
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogSPDivatt_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogSPDivatt_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogSPLang <- calculate_cvalue(EcogSPLang)
long_dat$EcogSPLang_cut <- ifelse(long_dat$EcogSPLang > cvalue$EcogSPLang, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogSPLang_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogSPLang <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogSPLang_cut) ~ thirtile, data = .)
logrank_test$EcogSPLang
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogSPLang_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogSPLang_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogSPMem <- calculate_cvalue(EcogSPMem)
long_dat$EcogSPMem_cut <- ifelse(long_dat$EcogSPMem > cvalue$EcogSPMem, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogSPMem_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogSPMem <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogSPMem_cut) ~ thirtile, data = .)
logrank_test$EcogSPMem
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogSPMem_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogSPMem_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogSPOrgan <- calculate_cvalue(EcogSPOrgan)
long_dat$EcogSPOrgan_cut <- ifelse(long_dat$EcogSPOrgan > cvalue$EcogSPOrgan, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogSPOrgan_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogSPOrgan <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogSPOrgan_cut) ~ thirtile, data = .)
logrank_test$EcogSPOrgan
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogSPOrgan_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogSPOrgan_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogSPPlan <- calculate_cvalue(EcogSPPlan)
long_dat$EcogSPPlan_cut <- ifelse(long_dat$EcogSPPlan > cvalue$EcogSPPlan, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogSPPlan_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogSPPlan <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogSPPlan_cut) ~ thirtile, data = .)
logrank_test$EcogSPPlan
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogSPPlan_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogSPPlan_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogSPVisspat <- calculate_cvalue(EcogSPVisspat)
long_dat$EcogSPVisspat_cut <- ifelse(long_dat$EcogSPVisspat > cvalue$EcogSPVisspat, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogSPVisspat_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogSPVisspat <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogSPVisspat_cut) ~ thirtile, data = .)
logrank_test$EcogSPVisspat
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogSPVisspat_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogSPVisspat_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
cvalue$EcogSPTotal <- calculate_cvalue(EcogSPTotal)
long_dat$EcogSPTotal_cut <- ifelse(long_dat$EcogSPTotal > cvalue$EcogSPTotal, 1, 0)
# Fit the Kaplan-Meier estimator
surv_fit <- long_dat %>%
filter(as.integer(VISCODE) <= 9) %>%
survfit(Surv(as.integer(VISCODE), EcogSPTotal_cut) ~ thirtile, data = .)
# Create the Kaplan-Meier survival plot
plot(surv_fit,
main = "Kaplan-Meier Survival Curve",
xlab = "Time",
ylab = "Survival Probability",
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2,
xlim = c(0, 10))
legend("bottomleft",
legend = c("Underachiever", "Average", "Overachiever"),
col = c("#021636", "#bbceed", "#0a77f5"),
lwd = 2)
axis(1, lwd = 1)  # Change x-axis thickness
axis(2, lwd = 1)  # Change y-axis thickness
# Log Rank Test
logrank_test$EcogSPTotal <- long_dat %>%
filter(thirtile != 2) %>%
survdiff(Surv(as.integer(VISCODE), EcogSPTotal_cut) ~ thirtile, data = .)
logrank_test$EcogSPTotal
# Histogram depicting the number of people measured at each time point by group by outcome
ggplot(long_dat %>% filter(!is.na(EcogSPTotal_cut)),
aes(x = as.integer(VISCODE), fill = factor(EcogSPTotal_cut))) +
geom_histogram(position = "identity", alpha = 0.6, binwidth = 2) +
scale_fill_manual(values = c("#bbceed", "#021636"), labels = c("Normal Cognition", "Impaired Cognition")) +
facet_wrap(~ thirtile, ncol = 3,
labeller = labeller(thirtile = c("1" = "Underperformed",
"2" = "Average",
"3" = "Overperformed"))) +
labs(title = "Number of observations by time by group by outcome",
x = "Time", y = "Number of participants",
fill = "Legend Title") +
theme_minimal() +
theme(axis.line = element_line(size = 0.5),
plot.title = element_text(hjust = 0.5, face = "bold")) +
geom_vline(xintercept = 9, linetype = "dashed", color = "#940914")  # Add  vertical dashed line
test <- long_dat %>% filter(AGE %in% 60:70)
# also test # people 65 to 75
age_60to70_df <- long_dat %>% # Data frame filtered for age
filter(AGE >= 60 & AGE <= 70)
View(age_60to70_df)
unique(age_60to70_df)
unique(age_60to70_df$RID)
length(unique(age_60to70_df$RID))
length(unique(age_65to75_df$RID))
age_65to75_df <- long_dat %>% # Data frame filtered for age
filter(AGE >= 65 & AGE <= 75)
length(unique(age_65to75_df$RID))
age_60to75_df <- long_dat %>% # Data frame filtered for age
filter(AGE >= 60 & AGE <= 75)
length(unique(age_60to75_df$RID))
